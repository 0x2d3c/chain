package types_test

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/require"

	"github.com/bandprotocol/chain/v2/x/tunnel/types"
)

func TestEncodeAbi(t *testing.T) {
	packet := types.Packet{
		TunnelID:     1,
		Nonce:        3,
		SignalPrices: []types.SignalPrice{{SignalID: "signal_01", Price: 2}},
		CreatedAt:    123,
	}

	tssPacket := types.NewTssPacket(packet)

	msg, err := tssPacket.EncodeAbi()
	require.NoError(t, err)

	expectedMsg := ("0000000000000000000000000000000000000000000000000000000000000020" +
		"0000000000000000000000000000000000000000000000000000000000000001" +
		"0000000000000000000000000000000000000000000000000000000000000003" +
		"0000000000000000000000000000000000000000000000000000000000000080" +
		"000000000000000000000000000000000000000000000000000000000000007b" +
		"0000000000000000000000000000000000000000000000000000000000000001" +
		"7369676e616c5f30310000000000000000000000000000000000000000000000" +
		"0000000000000000000000000000000000000000000000000000000000000002")

	require.Equal(t, expectedMsg, hex.EncodeToString(msg))
}
